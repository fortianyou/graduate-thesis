
CVB方法是变分方法的一个典型例子。该方法假设主题随机变量$z$之间相互独立，并且后验的近似为:
\begin{equation}
\hat{q}(\mathbf{z, \theta, \beta}) = \hat{q}(\mathbf{\theta, \beta | z}) \prod_{ij} \hat{q}(z_{ij}| \hat{\gamma}_{ij}).
\end{equation}
其中$ \hat{q}(z_{ij}| \hat{\gamma}_{ij})$是一个以$\hat{\gamma}_{ij}$为参数的多项式分布。
此时，ELBO为：
\begin{align*}
ELBO( \hat{q}(\mathbf{z})\hat{q}(\mathbf{\theta, \beta | z }) )
	&= \mathbb{E}_{\hat{q}(\mathbf{z})\hat{q}(\mathbf{\theta, \beta | z })}
[ \log p(\mathbf{w, z, \theta, \beta} | \alpha, \eta)] \\
 & \quad - \mathbb{E}_{\hat{q}(\mathbf{z})\hat{q}(\mathbf{\theta, \beta | z })}
[ \log \hat{q}(\mathbf{z}) \hat{q}(\mathbf{\theta, \beta | z}) ] \\
& = \mathbb{E}_{\hat{q}(\mathbf{z})}[ \mathbb{E}_{\hat{q}(\mathbf{\theta, \beta | z })}
[ \log p(\mathbf{w, z, \theta, \beta} | \alpha, \eta)] ]  \\
& \quad - \mathbb{E}_{\hat{q}(\mathbf{z})}[ \hat{q}(\mathbf{z}) ] -  \mathbb{E}_{\hat{q}(\mathbf{\theta, \beta | z })} [ \log \hat{q}(\mathbf{\theta, \beta | z}) ]
\end{align*}
根据上面的式子，如果固定$\hat{q}(\mathbf{\theta, \beta | z})$ 
，然后优化参数最大化ELBO。因此
\begin{equation} \label{eq:cvb}
ELBO(\hat{q}(\mathbf{z})) \triangleq \max_{\hat{q}(\mathbf{\theta, \beta| z })} { 
ELBO \left( \hat{q}(\mathbf{z})\hat{q}(\mathbf{\theta, \beta | z }) \right) }
= \mathbb{E}_{\hat{q}(\mathbf{z})} 
[ \log p(\mathbf{w, z} | \alpha, \eta)]  
 - \mathbb{E}_{\hat{q}(\mathbf{z})}[ \hat{q}(\mathbf{z}) ]
\end{equation}
很容易发现，算法求解并不在依赖于与$\theta, \beta$有关的项（相当于消除了参数$\theta, \beta$）。
这种方法相较于VB方法所带有的假设更少，因而能够得到更准确的近似估计。

对\ref{eq:cvb}进行优化求解得到了：
\begin{equation}
\label{eq:cvb_gamma}
\hat{\gamma}_{nmk} = \hat{q}(z_{nm} = k ) \propto \exp \left(\mathbb{E}_{\hat{q}(z^{\neg nm})} \left[\log \dfrac{(\alpha + n_{mk}^{\neg nm})
(\eta + n_{kw_{nm}}^{\neg nm})}{V\eta + n_{\cdot k}^{\neg nm}}\right]\right)
\end{equation}


